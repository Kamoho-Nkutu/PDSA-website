# azure-pipelines.yml
name: PDSA-Clinic-Website

trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- checkout: self

- script: |
    echo "üåê PDSA Veterinary Clinic - Static Website Build"
    echo "================================================"
    echo "Build: $(Build.BuildNumber)"
    echo "Branch: $(Build.SourceBranch)"
    echo "Commit: $(Build.SourceVersion)"
    echo ""
    
    # Validate website structure
    echo "üîç Validating website structure..."
    if [ -f "index.html" ]; then
        echo "‚úÖ index.html found"
    else
        echo "‚ùå ERROR: index.html not found!"
        exit 1
    fi
    
    # Check HTML structure
    if grep -q "<!DOCTYPE html>" index.html; then
        echo "‚úÖ Valid HTML5 doctype"
    else
        echo "‚ùå ERROR: Invalid HTML structure"
        exit 1
    fi
    
    # Show project files
    echo ""
    echo "üìÅ Project Files:"
    find . -name "*.html" -o -name "*.css" -o -name "*.js" | head -15
  displayName: 'Validate Website Structure'

- script: |
    echo "üìä File Analysis:"
    echo "HTML files: $(find . -name "*.html" | wc -l)"
    echo "CSS files: $(find . -name "*.css" | wc -l)"
    echo "JS files: $(find . -name "*.js" | wc -l)"
    echo "Total size: $(du -sh . | cut -f1)"
  displayName: 'File Analysis'

- task: ArchiveFiles@2
  inputs:
    rootFolderOrFile: '$(Build.SourcesDirectory)'
    includeRootFolder: false
    archiveType: 'zip'
    archiveFile: '$(Build.ArtifactStagingDirectory)/pdsa-website-$(Build.BuildNumber).zip'
    replaceExistingArchive: true
  displayName: 'Create Website Package'

- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: '$(Build.ArtifactStagingDirectory)'
    ArtifactName: 'pdsa-clinic-website'
  displayName: 'Publish Website'