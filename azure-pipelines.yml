name: Deploy PDSA Clinic

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Validate Website
      run: |
        echo "üåê PDSA Veterinary Clinic - GitHub Actions Build"
        echo "================================================"
        echo "Build: $GITHUB_RUN_ID"
        echo "Commit: $GITHUB_SHA"
        echo ""
        
        # Validate website structure
        if [ -f "index.html" ]; then
            echo "‚úÖ index.html found"
        else
            echo "‚ùå ERROR: index.html not found!"
            exit 1
        fi
        
        # Check HTML structure
        if grep -q "<!DOCTYPE html>" index.html; then
            echo "‚úÖ Valid HTML5 doctype"
        else
            echo "‚ùå ERROR: Invalid HTML structure"
            exit 1
        fi
        
        # Show project files
        echo ""
        echo "üìÅ Project Files:"
        find . -name "*.html" -o -name "*.css" -o -name "*.js" | head -15
        
        echo ""
        echo "üìä File Analysis:"
        echo "HTML files: $(find . -name "*.html" | wc -l)"
        echo "CSS files: $(find . -name "*.css" | wc -l)"
        echo "JS files: $(find . -name "*.js" | wc -l)"
        echo "Total size: $(du -sh . | cut -f1)"
        
        echo "üéâ PDSA Clinic validation completed successfully!"
    
    - name: Upload artifacts
      uses: actions/upload-artifact@v4
      with:
        name: pdsa-website
        path: |
          *.html
          *.css
          *.js
          images/
        retention-days: 7
