<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDSA Veterinary Clinic - Soweto</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Header Styles */
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo img {
            height: 50px;
        }
        
        .logo h1 {
            font-size: 1.5rem;
        }
        
        nav {
            display: flex;
            align-items: center;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 5px;
            margin: 0;
            padding: 0;
        }

        nav li {
            position: relative;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            position: relative;
        }
        
        nav a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        nav a.active {
            background-color: var(--secondary);
        }
        
        nav a.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background-color: var(--secondary);
            border-radius: 50%;
        }
        
        .auth-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .admin-link {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .admin-link:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .cart-icon {
            position: relative;
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .cart-icon:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn-primary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid white;
            color: white;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-info {
            background-color: var(--info);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-outline:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1583337130417-3346a1be7dee?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80');
            background-size: cover;
            background-position: center;
            min-height: 70vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            padding: 2rem;
            position: relative;
        }
        
        .hero h2 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-bottom: 1rem;
            animation: fadeInDown 1s ease;
        }
        
        .hero p {
            font-size: clamp(1rem, 2vw, 1.2rem);
            margin-bottom: 2rem;
            max-width: 700px;
            animation: fadeInUp 1s ease;
        }
        
        .hero-buttons {
            display: flex;
            gap: 15px;
            animation: fadeIn 1.5s ease;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .emergency-banner {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: var(--danger);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: pulse 2s infinite;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .emergency-banner:hover {
            background-color: #c0392b;
            transform: scale(1.05);
        }
        
        /* Services Section */
        .services {
            padding: 4rem 2rem;
            background-color: white;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .section-title h2 {
            font-size: clamp(1.5rem, 3vw, 2rem);
            color: var(--primary);
            margin-bottom: 1rem;
            position: relative;
            display: inline-block;
        }
        
        .section-title h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: var(--secondary);
        }
        
        .section-title p {
            max-width: 700px;
            margin: 0 auto;
            color: #666;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        
        .service-card {
            background-color: var(--light);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            border: 1px solid #eee;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .service-img {
            height: 200px;
            overflow: hidden;
        }
        
        .service-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .service-card:hover .service-img img {
            transform: scale(1.05);
        }
        
        .service-content {
            padding: 1.5rem;
        }
        
        .service-content h3 {
            margin-bottom: 0.5rem;
            color: var(--primary);
        }
        
        .service-content .price {
            color: var(--secondary);
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .service-content p {
            margin-bottom: 1rem;
            color: #666;
        }
        
        .service-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        /* Products Section */
        .products {
            padding: 4rem 2rem;
            background-color: var(--light);
        }
        
        .product-filters {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--secondary);
            background: white;
            color: var(--secondary);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-btn.active, .filter-btn:hover {
            background: var(--secondary);
            color: white;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }
        
        .product-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .product-img {
            height: 200px;
            overflow: hidden;
            position: relative;
        }
        
        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .product-card:hover .product-img img {
            transform: scale(1.05);
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--danger);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .product-content {
            padding: 1.5rem;
        }
        
        .product-content h3 {
            margin-bottom: 0.5rem;
            color: var(--primary);
        }
        
        .product-price {
            color: var(--secondary);
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        .old-price {
            text-decoration: line-through;
            color: #999;
            font-size: 0.9rem;
            margin-left: 0.5rem;
        }
        
        .product-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 0.5rem;
            color: #f39c12;
        }
        
        .product-rating span {
            color: #666;
            font-size: 0.9rem;
        }
        
        .product-description {
            color: #666;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
        }
        
        .quantity-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quantity-input {
            width: 50px;
            height: 30px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }
        
        .product-actions {
            display: flex;
            gap: 10px;
        }
        
        .product-actions .btn {
            flex: 1;
            justify-content: center;
        }
        
        /* Shopping Cart */
        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }
        
        .cart-overlay.open {
            display: block;
        }
        
        .cart-container {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            height: 100%;
            background-color: white;
            z-index: 1001;
            display: flex;
            flex-direction: column;
            transition: right 0.3s ease;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
        }
        
        .cart-container.open {
            right: 0;
        }
        
        .cart-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .cart-header h2 {
            color: var(--primary);
        }
        
        .close-cart {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }
        
        .cart-item {
            display: flex;
            gap: 10px;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .cart-item-img {
            width: 80px;
            height: 80px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .cart-item-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .cart-item-details {
            flex: 1;
        }
        
        .cart-item-details h4 {
            margin-bottom: 0.25rem;
            color: var(--primary);
        }
        
        .cart-item-price {
            color: var(--secondary);
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .cart-item-remove {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 1.1rem;
        }
        
        .empty-cart-message {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
        
        .empty-cart-message i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #ddd;
        }
        
        .cart-footer {
            padding: 1.5rem;
            border-top: 1px solid #eee;
        }
        
        .cart-total {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .cart-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        /* About Section */
        .about {
            padding: 4rem 2rem;
            background-color: white;
        }
        
        .about-container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
        }
        
        .about-img {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .about-img img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .about-content h2 {
            font-size: clamp(1.5rem, 3vw, 2rem);
            color: var(--primary);
            margin-bottom: 1.5rem;
        }
        
        .about-content p {
            margin-bottom: 1.5rem;
            color: #666;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .stat-item {
            text-align: center;
            padding: 1rem;
            background-color: var(--light);
            border-radius: 8px;
        }
        
        .stat-item h3 {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }
        
        .stat-item p {
            font-size: 0.9rem;
            color: #666;
        }
        
        /* Team Section */
        .team {
            padding: 4rem 2rem;
            background-color: var(--light);
        }
        
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .team-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: all 0.3s;
        }
        
        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .team-img {
            height: 250px;
            overflow: hidden;
        }
        
        .team-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .team-info {
            padding: 1.5rem;
        }
        
        .team-info h3 {
            margin-bottom: 0.5rem;
            color: var(--primary);
        }
        
        .team-info p {
            color: var(--secondary);
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .team-info .social-links {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 1rem;
        }
        
        .team-info .social-links a {
            color: var(--primary);
            background-color: var(--light);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .team-info .social-links a:hover {
            background-color: var(--secondary);
            color: white;
        }
        
        /* Testimonials Section */
        .testimonials {
            padding: 4rem 2rem;
            background-color: white;
        }
        
        .testimonial-slider {
            max-width: 800px;
            margin: 2rem auto 0;
            position: relative;
        }
        
        .testimonial {
            background-color: var(--light);
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .testimonial-content {
            font-style: italic;
            margin-bottom: 1.5rem;
            color: #555;
            position: relative;
        }
        
        .testimonial-content::before,
        .testimonial-content::after {
            content: '"';
            font-size: 3rem;
            color: var(--secondary);
            opacity: 0.3;
            position: absolute;
        }
        
        .testimonial-content::before {
            top: -20px;
            left: -10px;
        }
        
        .testimonial-content::after {
            bottom: -40px;
            right: -10px;
        }
        
        .testimonial-author {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 2rem;
        }
        
        .author-img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            overflow: hidden;
            margin-bottom: 1rem;
            border: 3px solid var(--secondary);
        }
        
        .author-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .author-info h4 {
            color: var(--primary);
            margin-bottom: 0.25rem;
        }
        
        .author-info p {
            color: #666;
            font-size: 0.9rem;
        }
        
        .slider-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 2rem;
        }
        
        .slider-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ddd;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .slider-dot.active {
            background-color: var(--secondary);
            transform: scale(1.2);
        }
        
        /* FAQ Section */
        .faq {
            padding: 4rem 2rem;
            background-color: var(--light);
        }
        
        .faq-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .faq-item {
            margin-bottom: 1rem;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .faq-question {
            background-color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .faq-question:hover {
            background-color: #f8f9fa;
        }
        
        .faq-question h3 {
            color: var(--primary);
            font-size: 1.1rem;
        }
        
        .faq-question i {
            transition: transform 0.3s;
        }
        
        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }
        
        .faq-answer {
            background-color: #f8f9fa;
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }
        
        .faq-item.active .faq-answer {
            padding: 1.5rem;
            max-height: 500px;
        }
        
        .faq-answer p {
            color: #666;
            line-height: 1.7;
        }
        
        /* Contact Section */
        .contact {
            padding: 4rem 2rem;
            background-color: white;
        }
        
        .contact-container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }
        
        .contact-info h2 {
            font-size: clamp(1.5rem, 3vw, 2rem);
            color: var(--primary);
            margin-bottom: 1.5rem;
        }
        
        .contact-info p {
            margin-bottom: 2rem;
            color: #666;
        }
        
        .contact-details {
            margin-bottom: 2rem;
        }
        
        .contact-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 1.5rem;
        }
        
        .contact-icon {
            background-color: var(--secondary);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .contact-text h3 {
            color: var(--primary);
            margin-bottom: 0.25rem;
        }
        
        .contact-text p, .contact-text a {
            color: #666;
            text-decoration: none;
        }
        
        .contact-text a:hover {
            color: var(--secondary);
        }
        
        .contact-map {
            height: 100%;
            min-height: 300px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .contact-map iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .contact-form {
            background-color: var(--light);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        /* Footer */
        footer {
            background-color: var(--primary);
            color: white;
            padding: 3rem 2rem;
        }
        
        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        
        .footer-col h3 {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .footer-col h3::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 2px;
            background-color: var(--secondary);
        }
        
        .footer-col p {
            margin-bottom: 1rem;
            color: #bbb;
        }
        
        .footer-col ul {
            list-style: none;
        }
        
        .footer-col ul li {
            margin-bottom: 0.75rem;
        }
        
        .footer-col ul li a {
            color: #bbb;
            text-decoration: none;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .footer-col ul li a:hover {
            color: white;
        }
        
        .social-links {
            display: flex;
            gap: 1rem;
        }
        
        .social-links a {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }
        
        .social-links a:hover {
            background-color: var(--secondary);
        }
        
        .newsletter-form {
            margin-top: 1rem;
        }
        
        .newsletter-form input {
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }
        
        .copyright {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #bbb;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-dialog {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }
        
        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            transition: color 0.3s;
        }
        
        .close-modal:hover {
            color: var(--danger);
        }
        
        .form-footer {
            margin-top: 1.5rem;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .form-footer a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 500;
        }
        
        .form-footer a:hover {
            text-decoration: underline;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 4px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            z-index: 10000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 350px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background-color: var(--success);
        }
        
        .notification.error {
            background-color: var(--danger);
        }
        
        .notification.info {
            background-color: var(--info);
        }
        
        .notification.warning {
            background-color: var(--warning);
        }
        
        .close-notification {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--primary);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--secondary);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        /* Additional styles for user authentication */
        .auth-required {
            position: relative;
        }
        
        .auth-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            z-index: 10;
            padding: 1rem;
            text-align: center;
        }
        
        .auth-overlay h3 {
            margin-bottom: 1rem;
            color: var(--primary);
        }
        
        .auth-overlay p {
            margin-bottom: 1.5rem;
            color: #666;
        }
        
        .login-prompt {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 1rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            position: relative;
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 4px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 0.5rem 0;
            min-width: 150px;
            z-index: 1000;
            display: none;
        }
        
        .user-dropdown a {
            display: block;
            padding: 0.5rem 1rem;
            color: var(--dark);
            text-decoration: none;
            transition: background-color 0.3s;
        }
        
        .user-dropdown a:hover {
            background-color: var(--light);
        }
        
        .user-profile:hover .user-dropdown {
            display: block;
        }
        
        /* Appointment Modal Styles */
        .appointment-modal .modal-dialog {
            max-width: 700px;
        }
        
        .appointment-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .appointment-form .form-group {
            margin-bottom: 1rem;
        }
        
        .appointment-form .full-width {
            grid-column: 1 / -1;
        }
        
        .appointment-calendar {
            margin-bottom: 1.5rem;
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .time-slot {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .time-slot:hover {
            background-color: #f0f0f0;
        }
        
        .time-slot.selected {
            background-color: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .time-slot.unavailable {
            background-color: #f8f8f8;
            color: #999;
            cursor: not-allowed;
        }
        
        /* User Dashboard */
        .dashboard {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .dashboard-section {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .dashboard-section h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .dashboard-card {
            background: var(--light);
            padding: 1rem;
            border-radius: 6px;
            border-left: 4px solid var(--secondary);
        }
        
        .dashboard-card h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .dashboard-card p {
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .dashboard-card .status {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-pending { background: #fff3cd; color: #856404; }
        .status-confirmed { background: #d1ecf1; color: #0c5460; }
        .status-completed { background: #d4edda; color: #155724; }
        .status-cancelled { background: #f8d7da; color: #721c24; }
        
        /* Admin specific styles */
        .admin-panel {
            background: #f8f9fa;
            border-left: 4px solid var(--danger);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .stat-card .number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--secondary);
            display: block;
        }
        
        .stat-card .label {
            color: #666;
            font-size: 0.9rem;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        
        .loading-spinner i {
            font-size: 2rem;
            color: var(--secondary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Stock Status */
        .stock-status {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }
        
        .in-stock {
            background-color: var(--success);
            color: white;
        }
        
        .low-stock {
            background-color: var(--warning);
            color: white;
        }
        
        .out-of-stock {
            background-color: var(--danger);
            color: white;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            nav ul {
                display: none;
            }
            
            .hero {
                min-height: 60vh;
                padding: 1rem;
            }
            
            .hero h2 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            .about-container,
            .contact-container {
                grid-template-columns: 1fr;
            }
            
            .contact-map {
                min-height: 400px;
                order: -1;
            }
            
            .appointment-form {
                grid-template-columns: 1fr;
            }
            
            .time-slots {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .cart-container {
                width: 100%;
                right: -100%;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .services, .products, .about, .team, .testimonials, .faq, .contact {
                padding: 2rem 1rem;
            }
        }
        
        @media (max-width: 576px) {
            .hero-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .hero-buttons .btn {
                width: 100%;
                justify-content: center;
            }
            
            .emergency-banner {
                position: static;
                margin-bottom: 1rem;
                width: 100%;
                justify-content: center;
            }
            
            .product-actions {
                flex-direction: column;
            }
            
            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-dialog {
                width: 95%;
                margin: 1rem;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Utility Classes */
        .text-center {
            text-align: center;
        }
        
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
        
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }
    </style>
</head>
<body>
    <!-- Public Website -->
    <div id="public-website">
        <header>
            <div class="logo">
                <img src="https://www.pdsa.org.uk/media/12121/pdsa-logo.png" alt="PDSA Logo">
                <h1>PDSA Veterinary Clinic</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#home" class="active">Home</a></li>
                    <li><a href="#services">Services</a></li>
                    <li><a href="#products">Products</a></li>
                    <li><a href="#about">About Us</a></li>
                    <li><a href="#team">Our Team</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
            <div class="auth-buttons">
                <div class="cart-icon" id="cart-btn">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </div>
                <button class="btn btn-outline" id="login-btn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="btn btn-primary" id="register-btn">
                    <i class="fas fa-user-plus"></i> Register
                </button>
                <a href="admin-dashboard.html" class="admin-link" id="admin-link" style="display: none;">
                    <i class="fas fa-cog"></i> Admin
                </a>
                <div id="user-menu" style="display: none;">
                    <div class="user-profile">
                        <span id="user-name"></span>
                        <i class="fas fa-chevron-down"></i>
                        <div class="user-dropdown">
                            <a href="#" id="user-dashboard-link">Dashboard</a>
                            <a href="profile.html" id="user-profile-link">My Profile</a>
                            <a href="my-pets.html" id="my-pets-link">My Pets</a>
                            <a href="appointments.html" id="my-appointments-link">Appointments</a>
                            <a href="#" id="my-orders-link">Orders</a>
                            <a href="logout.js" id="logout-link">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <section class="hero" id="home">
            <a href="tel:10111" class="emergency-banner" id="emergency-banner">
                <i class="fas fa-phone-alt"></i>
                <span>Emergency: 10111</span>
            </a>
            <h2>Compassionate Care for Your Pets</h2>
            <p>PDSA provides quality veterinary services to pets in Mfolo, Soweto. Book an appointment today and give your pet the care they deserve.</p>
            <div class="hero-buttons">
                <button class="btn btn-primary" id="book-appointment-btn">
                    <i class="fas fa-calendar-alt"></i> Book Appointment
                </button>
                <button class="btn btn-outline" id="learn-more-btn">
                    <i class="fas fa-info-circle"></i> Learn More
                </button>
            </div>
        </section>

        <section class="services" id="services">
            <div class="section-title">
                <h2>Our Services</h2>
                <p>We offer a wide range of veterinary services to keep your pets healthy and happy.</p>
            </div>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-img">
                        <img src="https://images.unsplash.com/photo-1530046339918-68a0c47a04f5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80" alt="Vaccination">
                    </div>
                    <div class="service-content">
                        <h3>Vaccinations</h3>
                        <div class="price">From R250</div>
                        <p>Protect your pet from preventable diseases with our comprehensive vaccination programs tailored to your pet's needs.</p>
                        <div class="service-meta">
                            <span><i class="fas fa-clock"></i> 30 mins</span>
                            <span><i class="fas fa-calendar-alt"></i> Annual</span>
                        </div>
                        <button class="btn btn-primary mt-2" style="width: 100%;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-img">
                        <img src="https://images.unsplash.com/photo-1583511655826-05700442b31f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80" alt="Surgery">
                    </div>
                    <div class="service-content">
                        <h3>Surgical Procedures</h3>
                        <div class="price">From R800</div>
                        <p>From routine spaying/neutering to complex surgeries, our experienced veterinary surgeons provide compassionate care.</p>
                        <div class="service-meta">
                            <span><i class="fas fa-clock"></i> 1-3 hours</span>
                            <span><i class="fas fa-procedures"></i> Hospitalization</span>
                        </div>
                        <button class="btn btn-primary mt-2" style="width: 100%;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-img">
                        <img src="https://images.unsplash.com/photo-1544568100-847a948585b9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80" alt="Dental Care">
                    </div>
                    <div class="service-content">
                        <h3>Dental Care</h3>
                        <div class="price">From R450</div>
                        <p>Comprehensive dental services including cleaning, extractions, and oral health assessments to maintain your pet's smile.</p>
                        <div class="service-meta">
                            <span><i class="fas fa-clock"></i> 45 mins</span>
                            <span><i class="fas fa-tooth"></i> Annual Check</span>
                        </div>
                        <button class="btn btn-primary mt-2" style="width: 100%;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-img">
                        <img src="https://images.unsplash.com/photo-1553284965-e2815db2e5a0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80" alt="Microchipping">
                    </div>
                    <div class="service-content">
                        <h3>Microchipping</h3>
                        <div class="price">R350</div>
                        <p>Ensure your pet can always be identified with our quick and painless microchipping service.</p>
                        <div class="service-meta">
                            <span><i class="fas fa-clock"></i> 15 mins</span>
                            <span><i class="fas fa-id-card"></i> Lifetime</span>
                        </div>
                        <button class="btn btn-primary mt-2" style="width: 100%;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-img">
                        <img src="https://images.unsplash.com/photo-1596276023096-329a9605c5c3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80" alt="Nutrition">
                    </div>
                    <div class="service-content">
                        <h3>Nutrition Counseling</h3>
                        <div class="price">From R300</div>
                        <p>Tailored dietary plans to address weight management, allergies, or specific health conditions for optimal pet health.</p>
                        <div class="service-meta">
                            <span><i class="fas fa-clock"></i> 45 mins</span>
                            <span><i class="fas fa-utensils"></i> Follow-ups</span>
                        </div>
                        <button class="btn btn-primary mt-2" style="width: 100%;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-img">
                        <img src="https://images.unsplash.com/photo-1575425186775-b8de9a427e67?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80" alt="Grooming">
                    </div>
                    <div class="service-content">
                        <h3>Professional Grooming</h3>
                        <div class="price">From R250</div>
                        <p>Full-service grooming including bathing, haircuts, nail trimming, and ear cleaning by our gentle professionals.</p>
                        <div class="service-meta">
                            <span><i class="fas fa-clock"></i> 1-2 hours</span>
                            <span><i class="fas fa-spa"></i> Monthly</span>
                        </div>
                        <button class="btn btn-primary mt-2" style="width: 100%;">
                            <i class="fas fa-info-circle"></i> Learn More
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section class="products" id="products">
            <div class="section-title">
                <h2>Pet Products</h2>
                <p>Shop our selection of high-quality pet supplies, food, and accessories.</p>
            </div>
            
            <div class="product-filters">
                <button class="filter-btn active" data-filter="all">All Products</button>
                <button class="filter-btn" data-filter="food">Food & Treats</button>
                <button class="filter-btn" data-filter="toys">Toys</button>
                <button class="filter-btn" data-filter="health">Health & Wellness</button>
                <button class="filter-btn" data-filter="accessories">Accessories</button>
            </div>
            
            <div class="products-grid">
                <!-- Product 1 -->
                <div class="product-card auth-required" data-category="food">
                    <div class="auth-overlay" id="product-auth-overlay-1">
                        <h3>Login Required</h3>
                        <p>Please login to add products to your cart</p>
                        <button class="btn btn-primary" id="login-from-product">
                            <i class="fas fa-sign-in-alt"></i> Login Now
                        </button>
                    </div>
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1589923188937-cb64779f4abe?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2071&q=80" alt="Premium Dog Food">
                        <div class="product-badge">Bestseller</div>
                    </div>
                    <div class="product-content">
                        <h3>Premium Dog Food</h3>
                        <div class="product-price">R249.99</div>
                        <div class="product-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            <span>(128)</span>
                        </div>
                        <p class="product-description">Nutrient-rich formula for adult dogs with chicken as the first ingredient.</p>
                        <div class="quantity-control">
                            <button class="quantity-btn" data-action="decrease">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="10">
                            <button class="quantity-btn" data-action="increase">+</button>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-outline"><i class="far fa-heart"></i> Wishlist</button>
                            <button class="btn btn-primary add-to-cart" data-product-id="prod1" data-product-name="Premium Dog Food" data-product-price="249.99"><i class="fas fa-cart-plus"></i> Add to Cart</button>
                        </div>
                    </div>
                </div>
                
                <!-- Product 2 -->
                <div class="product-card auth-required" data-category="toys">
                    <div class="auth-overlay" id="product-auth-overlay-2">
                        <h3>Login Required</h3>
                        <p>Please login to add products to your cart</p>
                        <button class="btn btn-primary" id="login-from-product">
                            <i class="fas fa-sign-in-alt"></i> Login Now
                        </button>
                    </div>
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1550747534-8c5da7c08b71?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2072&q=80" alt="Interactive Cat Toy">
                    </div>
                    <div class="product-content">
                        <h3>Interactive Cat Toy</h3>
                        <div class="product-price">R89.99</div>
                        <div class="product-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                            <span>(64)</span>
                        </div>
                        <p class="product-description">Keeps your cat entertained for hours with feather attachments and unpredictable movements.</p>
                        <div class="quantity-control">
                            <button class="quantity-btn" data-action="decrease">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="10">
                            <button class="quantity-btn" data-action="increase">+</button>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-outline"><i class="far fa-heart"></i> Wishlist</button>
                            <button class="btn btn-primary add-to-cart" data-product-id="prod2" data-product-name="Interactive Cat Toy" data-product-price="89.99"><i class="fas fa-cart-plus"></i> Add to Cart</button>
                        </div>
                    </div>
                </div>
                
                <!-- Product 3 -->
                <div class="product-card auth-required" data-category="health">
                    <div class="auth-overlay" id="product-auth-overlay-3">
                        <h3>Login Required</h3>
                        <p>Please login to add products to your cart</p>
                        <button class="btn btn-primary" id="login-from-product">
                            <i class="fas fa-sign-in-alt"></i> Login Now
                        </button>
                    </div>
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1597484661643-3adc745bbd4a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80" alt="Flea & Tick Treatment">
                        <div class="product-badge">Sale</div>
                    </div>
                    <div class="product-content">
                        <h3>Flea & Tick Treatment</h3>
                        <div class="product-price">R179.99 <span class="old-price">R219.99</span></div>
                        <div class="product-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <span>(92)</span>
                        </div>
                        <p class="product-description">3-month supply. Kills fleas, ticks, and chewing lice while preventing reinfestation.</p>
                        <div class="quantity-control">
                            <button class="quantity-btn" data-action="decrease">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="10">
                            <button class="quantity-btn" data-action="increase">+</button>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-outline"><i class="far fa-heart"></i> Wishlist</button>
                            <button class="btn btn-primary add-to-cart" data-product-id="prod3" data-product-name="Flea & Tick Treatment" data-product-price="179.99"><i class="fas fa-cart-plus"></i> Add to Cart</button>
                        </div>
                    </div>
                </div>
                
                <!-- Product 4 -->
                <div class="product-card auth-required" data-category="accessories">
                    <div class="auth-overlay" id="product-auth-overlay-4">
                        <h3>Login Required</h3>
                        <p>Please login to add products to your cart</p>
                        <button class="btn btn-primary" id="login-from-product">
                            <i class="fas fa-sign-in-alt"></i> Login Now
                        </button>
                    </div>
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1551290464-4a2e098d03a5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2076&q=80" alt="Designer Dog Collar">
                    </div>
                    <div class="product-content">
                        <h3>Designer Dog Collar</h3>
                        <div class="product-price">R149.99</div>
                        <div class="product-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            <span>(47)</span>
                        </div>
                        <p class="product-description">Durable nylon collar with reflective stitching for nighttime visibility. Adjustable for perfect fit.</p>
                        <div class="quantity-control">
                            <button class="quantity-btn" data-action="decrease">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="10">
                            <button class="quantity-btn" data-action="increase">+</button>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-outline"><i class="far fa-heart"></i> Wishlist</button>
                            <button class="btn btn-primary add-to-cart" data-product-id="prod4" data-product-name="Designer Dog Collar" data-product-price="149.99"><i class="fas fa-cart-plus"></i> Add to Cart</button>
                        </div>
                    </div>
                </div>
                
                <!-- Product 5 -->
                <div class="product-card auth-required" data-category="food">
                    <div class="auth-overlay" id="product-auth-overlay-5">
                        <h3>Login Required</h3>
                        <p>Please login to add products to your cart</p>
                        <button class="btn btn-primary" id="login-from-product">
                            <i class="fas fa-sign-in-alt"></i> Login Now
                        </button>
                    </div>
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1597848212620-4f5f3d3b3db5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2072&q=80" alt="Grain-Free Cat Food">
                    </div>
                    <div class="product-content">
                        <h3>Grain-Free Cat Food</h3>
                        <div class="product-price">R199.99</div>
                        <div class="product-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                            <span>(56)</span>
                        </div>
                        <p class="product-description">High-protein, grain-free formula with real salmon for optimal feline health.</p>
                        <div class="quantity-control">
                            <button class="quantity-btn" data-action="decrease">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="10">
                            <button class="quantity-btn" data-action="increase">+</button>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-outline"><i class="far fa-heart"></i> Wishlist</button>
                            <button class="btn btn-primary add-to-cart" data-product-id="prod5" data-product-name="Grain-Free Cat Food" data-product-price="199.99"><i class="fas fa-cart-plus"></i> Add to Cart</button>
                        </div>
                    </div>
                </div>
                
                <!-- Product 6 -->
                <div class="product-card auth-required" data-category="health">
                    <div class="auth-overlay" id="product-auth-overlay-6">
                        <h3>Login Required</h3>
                        <p>Please login to add products to your cart</p>
                        <button class="btn btn-primary" id="login-from-product">
                            <i class="fas fa-sign-in-alt"></i> Login Now
                        </button>
                    </div>
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1583337130417-3346a1be7dee?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80" alt="Joint Supplement">
                    </div>
                    <div class="product-content">
                        <h3>Joint Supplement</h3>
                        <div class="product-price">R289.99</div>
                        <div class="product-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <span>(112)</span>
                        </div>
                        <p class="product-description">Supports joint health and mobility with glucosamine, chondroitin, and MSM.</p>
                        <div class="quantity-control">
                            <button class="quantity-btn" data-action="decrease">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="10">
                            <button class="quantity-btn" data-action="increase">+</button>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-outline"><i class="far fa-heart"></i> Wishlist</button>
                            <button class="btn btn-primary add-to-cart" data-product-id="prod6" data-product-name="Joint Supplement" data-product-price="289.99"><i class="fas fa-cart-plus"></i> Add to Cart</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="about" id="about">
            <div class="about-container">
                <div class="about-img">
                    <img src="https://images.unsplash.com/photo-1583512603805-3cc6b41f3edb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2080&q=80" alt="PDSA Clinic">
                </div>
                <div class="about-content">
                    <h2>About PDSA Veterinary Clinic</h2>
                    <p>Founded in 2010, PDSA Veterinary Clinic has been serving the Mfolo community with dedication and compassion. We believe that every pet deserves to live a happy and healthy life.</p>
                    <p>Our modern clinic is equipped with state-of-the-art facilities and staffed by compassionate professionals dedicated to providing the highest standard of care for your beloved pets.</p>
                    <p>We offer a range of services from routine check-ups to complex surgical procedures, all delivered with kindness and expertise.</p>
                    
                    <div class="stats">
                        <div class="stat-item">
                            <h3>10+</h3>
                            <p>Years of Service</p>
                        </div>
                        <div class="stat-item">
                            <h3>5K+</h3>
                            <p>Pets Treated Annually</p>
                        </div>
                        <div class="stat-item">
                            <h3>24/7</h3>
                            <p>Emergency Care</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="team" id="team">
            <div class="section-title">
                <h2>Meet Our Team</h2>
                <p>Our dedicated team of veterinary professionals are here to provide the best care for your pets.</p>
            </div>
            <div class="team-grid">
                <div class="team-card">
                    <div class="team-img">
                        <img src="https://randomuser.me/api/portraits/women/65.jpg" alt="Dr. Sarah Johnson">
                    </div>
                    <div class="team-info">
                        <h3>Dr. Sarah Johnson</h3>
                        <p>Head Veterinarian</p>
                        <p>Specializes in small animal surgery with 15 years of experience.</p>
                        <div class="social-links">
                            <a href="#"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#"><i class="fas fa-envelope"></i></a>
                        </div>
                    </div>
                </div>
                <div class="team-card">
                    <div class="team-img">
                        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Dr. Michael Brown">
                    </div>
                    <div class="team-info">
                        <h3>Dr. Michael Brown</h3>
                        <p>Senior Veterinarian</p>
                        <p>Expert in internal medicine and chronic conditions.</p>
                        <div class="social-links">
                            <a href="#"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#"><i class="fas fa-envelope"></i></a>
                        </div>
                    </div>
                </div>
                <div class="team-card">
                    <div class="team-img">
                        <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Dr. Emma Wilson">
                    </div>
                    <div class="team-info">
                        <h3>Dr. Emma Wilson</h3>
                        <p>Emergency Veterinarian</p>
                        <p>Available 24/7 for critical and emergency cases.</p>
                        <div class="social-links">
                            <a href="#"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#"><i class="fas fa-envelope"></i></a>
                        </div>
                    </div>
                </div>
                <div class="team-card">
                    <div class="team-img">
                        <img src="https://randomuser.me/api/portraits/men/75.jpg" alt="David Lee">
                    </div>
                    <div class="team-info">
                        <h3>David Lee</h3>
                        <p>Veterinary Nurse</p>
                        <p>Specialized in postoperative care and rehabilitation.</p>
                        <div class="social-links">
                            <a href="#"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#"><i class="fas fa-envelope"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="testimonials">
            <div class="section-title">
                <h2>What Our Clients Say</h2>
                <p>Hear from pet owners who have trusted us with their furry family members.</p>
            </div>
            <div class="testimonial-slider">
                <div class="testimonial">
                    <div class="testimonial-content">
                        The care my dog received at PDSA was exceptional. When Max needed emergency surgery, the team acted quickly and professionally. They kept me informed throughout the entire process and showed genuine compassion for both me and my pet.
                    </div>
                    <div class="testimonial-author">
                        <div class="author-img">
                            <img src="https://randomuser.me/api/portraits/women/33.jpg" alt="Lisa Chen">
                        </div>
                        <div class="author-info">
                            <h4>Lisa Chen</h4>
                            <p>Dog Owner</p>
                        </div>
                    </div>
                </div>
                <div class="slider-nav">
                    <div class="slider-dot active"></div>
                    <div class="slider-dot"></div>
                    <div class="slider-dot"></div>
                </div>
            </div>
        </section>

        <section class="faq" id="faq">
            <div class="section-title">
                <h2>Frequently Asked Questions</h2>
                <p>Find answers to common questions about our services and policies.</p>
            </div>
            <div class="faq-container">
                <div class="faq-item">
                    <div class="faq-question">
                        <h3>What are your opening hours?</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Our clinic is open Monday to Friday from 8:00 AM to 7:00 PM, and Saturdays from 9:00 AM to 4:00 PM. We are closed on Sundays except for emergency cases. Our 24/7 emergency service is always available for critical cases.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <h3>Do I need to register my pet before booking an appointment?</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes, we require all pets to be registered with our clinic before their first appointment. You can register your pet online through our portal or in person at the clinic. Registration helps us maintain complete medical records for your pet and ensures we can provide the best possible care.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <h3>What payment methods do you accept?</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>We accept all major credit and debit cards (Visa, MasterCard, American Express), cash, and contactless payments. We also offer payment plans for certain procedures - please ask our reception staff for details.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <h3>How do I know if my pet needs emergency care?</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Signs that your pet may need emergency care include difficulty breathing, seizures, uncontrolled bleeding, sudden paralysis, loss of consciousness, bloated or distented abdomen, poisoning, severe trauma (like being hit by a car), inability to urinate or defecate, or extreme pain. If you're unsure, please call our emergency line immediately at 011 984 4340.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <h3>Do you offer pet insurance claims?</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes, we work with most pet insurance providers. You will need to pay for the treatment upfront and then claim back from your insurer. Our team can provide all necessary documentation to support your claim. Some insurance companies offer direct claims - please check with your provider and inform our reception staff when you arrive.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="contact" id="contact">
            <div class="contact-container">
                <div class="contact-info">
                    <h2>Contact Us</h2>
                    <p>Have questions or need to get in touch? We're here to help you and your pet.</p>
                    
                    <div class="contact-details">
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="contact-text">
                                <h3>Our Location</h3>
                                <p>1188 Nancefield Moroka Road, Mfolo South, Soweto, 1868</p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-phone-alt"></i>
                            </div>
                            <div class="contact-text">
                                <h3>Call Us</h3>
                                <p>Main: 011 984 4340</p>
                                <p>Emergency: 011 984 4340</p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="contact-text">
                                <h3>Email Us</h3>
                                <a href="mailto:info@pdsa.org.za">info@pdsa.org.za</a>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="contact-text">
                                <h3>Opening Hours</h3>
                                <p>Mon-Fri: 8:00 AM - 7:00 PM</p>
                                <p>Sat: 9:00 AM - 4:00 PM</p>
                                <p>Sun: Emergency only</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="contact-map">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3576.340050682773!2d27.8589117764842!3d-26.31534437691821!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1e95a6c8d3c5f1c5%3A0x7c3d5e5a5a5a5a5a!2sMfolo%2C%20Soweto%2C%201868!5e0!3m2!1sen!2sza!4v1686754321235!5m2!1sen!2sza" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <div class="contact-form">
                    <h3>Send Us a Message</h3>
                    <form id="contact-form">
                        <div class="form-group">
                            <label for="contact-name">Your Name</label>
                            <input type="text" id="contact-name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="contact-email">Email</label>
                            <input type="email" id="contact-email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="contact-phone">Phone Number</label>
                            <input type="tel" id="contact-phone" name="phone">
                        </div>
                        <div class="form-group">
                            <label for="contact-subject">Subject</label>
                            <select id="contact-subject" name="subject">
                                <option value="general">General Inquiry</option>
                                <option value="appointment">Appointment Question</option>
                                <option value="emergency">Emergency</option>
                                <option value="feedback">Feedback</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="contact-message">Message</label>
                            <textarea id="contact-message" name="message" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            <i class="fas fa-paper-plane"></i> Send Message
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <footer>
            <div class="footer-container">
                <div class="footer-col">
                    <h3>About PDSA</h3>
                    <p>PDSA is Soweto's leading veterinary clinic. We've been taking care of the community's pets since 2010, providing quality veterinary services to pets in need.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#home"><i class="fas fa-chevron-right"></i> Home</a></li>
                        <li><a href="#services"><i class="fas fa-chevron-right"></i> Services</a></li>
                        <li><a href="#products"><i class="fas fa-chevron-right"></i> Products</a></li>
                        <li><a href="#about"><i class="fas fa-chevron-right"></i> About Us</a></li>
                        <li><a href="#team"><i class="fas fa-chevron-right"></i> Our Team</a></li>
                        <li><a href="#contact"><i class="fas fa-chevron-right"></i> Contact</a></li>
                        <li><a href="#" id="footer-book-appointment"><i class="fas fa-chevron-right"></i> Book Appointment</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Services</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Vaccinations</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Surgical Procedures</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Dental Care</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Emergency Care</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Microchipping</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Pet Health Advice</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Newsletter</h3>
                    <p>Subscribe to our newsletter for pet care tips, clinic updates, and special offers.</p>
                    <div class="newsletter-form">
                        <input type="email" placeholder="Your email address">
                        <button class="btn btn-primary" style="width: 100%;">Subscribe</button>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 PDSA Veterinary Clinic. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <!-- Shopping Cart -->
    <div class="cart-overlay" id="cart-overlay"></div>
    <div class="cart-container" id="cart-container">
        <div class="cart-header">
            <h2>Your Shopping Cart</h2>
            <button class="close-cart" id="close-cart">&times;</button>
        </div>
        <div class="cart-items" id="cart-items">
            <div class="empty-cart-message" id="empty-cart-message">
                <i class="fas fa-shopping-cart"></i>
                <p>Your cart is empty</p>
                <a href="#products" class="btn btn-primary">Continue Shopping</a>
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cart-total-amount">R0.00</span>
            </div>
            <div class="cart-buttons">
                <button class="btn btn-outline" id="continue-shopping">Continue Shopping</button>
                <button class="btn btn-primary" id="checkout-btn" disabled>Proceed to Checkout</button>
            </div>
        </div>
    </div>

    <!-- Enhanced Modals -->
    <div class="modal-overlay" id="login-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h2>Login to Your Account</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-email">Email Address</label>
                        <input type="email" id="login-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" name="password" required>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                    </div>
                    <div class="form-footer">
                        <p>Don't have an account? <a href="#" id="show-register">Register here</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="register-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h2>Create New Account</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="register-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="register-firstname">First Name</label>
                            <input type="text" id="register-firstname" name="firstname" required>
                        </div>
                        <div class="form-group">
                            <label for="register-lastname">Last Name</label>
                            <input type="text" id="register-lastname" name="lastname" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email Address</label>
                        <input type="email" id="register-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-phone">Phone Number</label>
                        <input type="tel" id="register-phone" name="phone">
                    </div>
                    <div class="form-group">
                        <label for="register-address">Address</label>
                        <textarea id="register-address" name="address" rows="2"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="register-password">Password</label>
                            <input type="password" id="register-password" name="password" required>
                        </div>
                        <div class="form-group">
                            <label for="register-confirm-password">Confirm Password</label>
                            <input type="password" id="register-confirm-password" name="confirmPassword" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            <i class="fas fa-user-plus"></i> Create Account
                        </button>
                    </div>
                    <div class="form-footer">
                        <p>Already have an account? <a href="#" id="show-login">Login here</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Enhanced Appointment Modal -->
    <div class="modal-overlay" id="appointment-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h2>Book an Appointment</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="appointment-step-1">
                    <form id="appointment-form">
                        <div class="form-group">
                            <label for="appointment-pet">Select Pet</label>
                            <select id="appointment-pet" required>
                                <option value="">Select a pet</option>
                            </select>
                            <small><a href="#" id="add-pet-link">Add new pet</a></small>
                        </div>
                        <div class="form-group">
                            <label for="appointment-service">Service Type</label>
                            <select id="appointment-service" required>
                                <option value="">Select a service</option>
                                <option value="1">General Checkup - R250</option>
                                <option value="2">Vaccination - R200</option>
                                <option value="3">Dental Cleaning - R450</option>
                                <option value="4">Spaying/Neutering - R800</option>
                                <option value="5">Microchipping - R350</option>
                                <option value="6">Grooming Service - R250</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="appointment-date">Preferred Date</label>
                                <input type="date" id="appointment-date" required min="">
                            </div>
                            <div class="form-group">
                                <label for="appointment-time">Preferred Time</label>
                                <select id="appointment-time" required>
                                    <option value="">Select a time</option>
                                    <option value="09:00">09:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="14:00">02:00 PM</option>
                                    <option value="15:00">03:00 PM</option>
                                    <option value="16:00">04:00 PM</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="appointment-reason">Reason for Visit</label>
                            <textarea id="appointment-reason" rows="3" placeholder="Please describe the reason for your visit"></textarea>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" style="width: 100%;">
                                <i class="fas fa-calendar-check"></i> Book Appointment
                            </button>
                        </div>
                    </form>
                </div>
                <div id="appointment-step-2" style="display: none;">
                    <div class="appointment-confirmation">
                        <h3>Appointment Confirmation</h3>
                        <div class="confirmation-details">
                            <div class="confirmation-item">
                                <span class="confirmation-label">Pet:</span>
                                <span class="confirmation-value" id="confirm-pet"></span>
                            </div>
                            <div class="confirmation-item">
                                <span class="confirmation-label">Service:</span>
                                <span class="confirmation-value" id="confirm-service"></span>
                            </div>
                            <div class="confirmation-item">
                                <span class="confirmation-label">Date:</span>
                                <span class="confirmation-value" id="confirm-date"></span>
                            </div>
                            <div class="confirmation-item">
                                <span class="confirmation-label">Time:</span>
                                <span class="confirmation-value" id="confirm-time"></span>
                            </div>
                            <div class="confirmation-item full-width">
                                <span class="confirmation-label">Reason:</span>
                                <span class="confirmation-value" id="confirm-reason"></span>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-outline" id="edit-appointment">Edit Details</button>
                            <button class="btn btn-primary" id="confirm-appointment">Confirm Booking</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Pet Modal -->
    <div class="modal-overlay" id="add-pet-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h2>Add New Pet</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-pet-form">
                    <div class="form-group">
                        <label for="pet-name">Pet Name *</label>
                        <input type="text" id="pet-name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="pet-species">Species *</label>
                        <select id="pet-species" name="species" required>
                            <option value="">Select Species</option>
                            <option value="dog">Dog</option>
                            <option value="cat">Cat</option>
                            <option value="bird">Bird</option>
                            <option value="rabbit">Rabbit</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pet-breed">Breed</label>
                        <input type="text" id="pet-breed" name="breed">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pet-dob">Date of Birth</label>
                            <input type="date" id="pet-dob" name="dateOfBirth">
                        </div>
                        <div class="form-group">
                            <label for="pet-gender">Gender</label>
                            <select id="pet-gender" name="gender">
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pet-color">Color/Markings</label>
                            <input type="text" id="pet-color" name="color">
                        </div>
                        <div class="form-group">
                            <label for="pet-weight">Weight (kg)</label>
                            <input type="number" id="pet-weight" name="weight" step="0.1" min="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pet-microchip">Microchip Number</label>
                        <input type="text" id="pet-microchip" name="microchipNumber">
                    </div>
                    <div class="form-group">
                        <label for="pet-medical-notes">Medical Notes</label>
                        <textarea id="pet-medical-notes" name="medicalNotes" rows="3" placeholder="Any known allergies, conditions, or special needs"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline" id="cancel-add-pet">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Add Pet
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- User Dashboard Modal -->
    <div class="modal-overlay" id="dashboard-modal">
        <div class="modal-dialog" style="max-width: 800px;">
            <div class="modal-header">
                <h2>My Dashboard</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="dashboard">
                    <div class="dashboard-section">
                        <h3>Quick Actions</h3>
                        <div class="dashboard-grid">
                            <div class="dashboard-card">
                                <h4>Book Appointment</h4>
                                <p>Schedule a new veterinary appointment</p>
                                <button class="btn btn-primary btn-sm" onclick="showAppointmentModal()">Book Now</button>
                            </div>
                            <div class="dashboard-card">
                                <h4>Add Pet</h4>
                                <p>Register a new pet</p>
                                <button class="btn btn-primary btn-sm" onclick="showAddPetModal()">Add Pet</button>
                            </div>
                            <div class="dashboard-card">
                                <h4>Shop Products</h4>
                                <p>Browse our pet products</p>
                                <button class="btn btn-primary btn-sm" onclick="scrollToProducts()">Shop Now</button>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-section">
                        <h3>My Pets</h3>
                        <div id="user-pets-list">
                            <div class="loading-spinner">
                                <i class="fas fa-spinner"></i>
                                <p>Loading pets...</p>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-section">
                        <h3>Upcoming Appointments</h3>
                        <div id="user-appointments-list">
                            <div class="loading-spinner">
                                <i class="fas fa-spinner"></i>
                                <p>Loading appointments...</p>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-section">
                        <h3>Recent Orders</h3>
                        <div id="user-orders-list">
                            <div class="loading-spinner">
                                <i class="fas fa-spinner"></i>
                                <p>Loading orders...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Admin Panel (only visible to admins) -->
                    <div class="dashboard-section admin-panel" id="admin-panel" style="display: none;">
                        <h3><i class="fas fa-cog"></i> Admin Panel</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <span class="number" id="stat-appointments">0</span>
                                <span class="label">Today's Appointments</span>
                            </div>
                            <div class="stat-card">
                                <span class="number" id="stat-orders">0</span>
                                <span class="label">Pending Orders</span>
                            </div>
                            <div class="stat-card">
                                <span class="number" id="stat-low-stock">0</span>
                                <span class="label">Low Stock Items</span>
                            </div>
                            <div class="stat-card">
                                <span class="number" id="stat-revenue">R0</span>
                                <span class="label">Today's Revenue</span>
                            </div>
                        </div>
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-danger" onclick="showAdminPanel()">Full Admin Dashboard</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification System -->
    <div id="notification-container"></div>

   <script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyB6QmZtUg2qajsUfeii7MBkDmGEbm5JkOE",
        authDomain: "pdsa-database.firebaseapp.com",
        databaseURL: "https://pdsa-database-default-rtdb.firebaseio.com",
        projectId: "pdsa-database",
        storageBucket: "pdsa-database.firebasestorage.app",
        messagingSenderId: "1041468794677",
        appId: "1:1041468794677:web:e7d38f76c644173cf48e7c",
        measurementId: "G-8QLD9BK9M0"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    // Application State
    const AppState = {
        currentUser: null,
        cart: [],
        userPets: [],
        userAppointments: [],
        userOrders: [],
        isAdmin: false,
        services: [
            { id: 1, name: "General Checkup", price: 250 },
            { id: 2, name: "Vaccination", price: 200 },
            { id: 3, name: "Dental Cleaning", price: 450 },
            { id: 4, name: "Spaying/Neutering", price: 800 },
            { id: 5, name: "Microchipping", price: 350 },
            { id: 6, name: "Grooming Service", price: 250 }
        ]
    };

    // DOM Elements
    const DOM = {
        modals: {
            login: document.getElementById('login-modal'),
            register: document.getElementById('register-modal'),
            appointment: document.getElementById('appointment-modal'),
            addPet: document.getElementById('add-pet-modal'),
            dashboard: document.getElementById('dashboard-modal')
        },
        cart: {
            overlay: document.getElementById('cart-overlay'),
            container: document.getElementById('cart-container'),
            items: document.getElementById('cart-items'),
            total: document.getElementById('cart-total-amount'),
            checkoutBtn: document.getElementById('checkout-btn')
        },
        auth: {
            loginBtn: document.getElementById('login-btn'),
            registerBtn: document.getElementById('register-btn'),
            userMenu: document.getElementById('user-menu'),
            userName: document.getElementById('user-name'),
            adminLink: document.getElementById('admin-link')
        }
    };

    // Initialize the application
    document.addEventListener('DOMContentLoaded', function() {
        initApplication();
    });

    // Application Initialization
    function initApplication() {
        initCart();
        setupEventListeners();
        setupAppointmentBooking();
        setupModals();
        setupDateRestrictions();
        setupCartIconToProducts();
        
        // Firebase auth state listener
        auth.onAuthStateChanged((user) => {
            if (user) {
                AppState.currentUser = {
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName || user.email.split('@')[0],
                    emailVerified: user.emailVerified
                };
                
                // Check if user is admin
                checkAdminStatus(user.uid);
                
                updateUserUI(AppState.currentUser);
                loadUserData();
            } else {
                AppState.currentUser = null;
                AppState.isAdmin = false;
                AppState.userPets = [];
                AppState.userAppointments = [];
                AppState.userOrders = [];
            }
            updateAuthUI();
        });
        
        showNotification('Welcome to PDSA Veterinary Clinic!', 'info');
    }

    // Cart Management
    function initCart() {
        const savedCart = localStorage.getItem('pdsaCart');
        if (savedCart) {
            try {
                AppState.cart = JSON.parse(savedCart);
                updateCartUI();
            } catch (error) {
                console.error('Error parsing saved cart:', error);
                AppState.cart = [];
                localStorage.removeItem('pdsaCart');
            }
        }
    }

    function updateCartUI() {
        try {
            const cartCountElement = document.querySelector('.cart-count');
            if (cartCountElement) {
                const totalItems = AppState.cart.reduce((total, item) => total + (item.quantity || 1), 0);
                cartCountElement.textContent = totalItems;
            }
            
            const cartItems = DOM.cart.items;
            if (!cartItems) return;
            
            cartItems.innerHTML = '';
            
            if (AppState.cart.length === 0) {
                const emptyCartMessage = document.getElementById('empty-cart-message');
                if (emptyCartMessage) {
                    emptyCartMessage.style.display = 'block';
                    emptyCartMessage.innerHTML = `
                        <i class="fas fa-shopping-cart" style="font-size: 3rem; color: #ddd; margin-bottom: 1rem;"></i>
                        <p style="margin-bottom: 1rem;">Your cart is empty</p>
                        <button class="btn btn-primary" id="browse-products-from-cart">
                            <i class="fas fa-paw"></i> Browse Products
                        </button>
                    `;
                    
                    // Add event listener to browse products button
                    const browseBtn = document.getElementById('browse-products-from-cart');
                    if (browseBtn) {
                        browseBtn.onclick = function() {
                            closeCart();
                            const productsSection = document.getElementById('products');
                            if (productsSection) {
                                productsSection.scrollIntoView({ 
                                    behavior: 'smooth',
                                    block: 'start'
                                });
                            }
                        };
                    }
                }
                if (DOM.cart.checkoutBtn) {
                    DOM.cart.checkoutBtn.disabled = true;
                }
            } else {
                const emptyCartMessage = document.getElementById('empty-cart-message');
                if (emptyCartMessage) {
                    emptyCartMessage.style.display = 'none';
                }
                if (DOM.cart.checkoutBtn) {
                    DOM.cart.checkoutBtn.disabled = false;
                }
                
                AppState.cart.forEach(item => {
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <div class="cart-item-img">
                            <img src="${item.image || 'https://via.placeholder.com/80'}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/80'">
                        </div>
                        <div class="cart-item-details">
                            <h4>${item.name || 'Unknown Product'}</h4>
                            <div class="cart-item-price">R${parseFloat(item.price || 0).toFixed(2)}</div>
                            <div class="cart-item-quantity">
                                <button class="quantity-btn" data-action="decrease" data-id="${item.id}">-</button>
                                <span>${item.quantity || 1}</span>
                                <button class="quantity-btn" data-action="increase" data-id="${item.id}">+</button>
                            </div>
                        </div>
                        <button class="cart-item-remove" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    cartItems.appendChild(cartItem);
                });
            }
            
            const cartTotalElement = DOM.cart.total;
            if (cartTotalElement) {
                const total = AppState.cart.reduce((sum, item) => {
                    const price = parseFloat(item.price || 0);
                    const quantity = item.quantity || 1;
                    return sum + (price * quantity);
                }, 0);
                cartTotalElement.textContent = `R${total.toFixed(2)}`;
            }
            
            // Add event listeners to cart buttons
            setTimeout(() => {
                document.querySelectorAll('.cart-item-remove').forEach(btn => {
                    btn.onclick = function() {
                        const productId = this.getAttribute('data-id');
                        removeFromCart(productId);
                    };
                });
                
                document.querySelectorAll('.cart-item .quantity-btn').forEach(btn => {
                    btn.onclick = function() {
                        const action = this.getAttribute('data-action');
                        const productId = this.getAttribute('data-id');
                        updateCartQuantity(productId, action);
                    };
                });
            }, 100);
            
            saveCart();
        } catch (error) {
            console.error('Error updating cart UI:', error);
        }
    }

    function addToCart(productId, productName, productPrice, productImage, quantity = 1) {
        // Validate inputs
        if (!productId || !productName) {
            console.error('Invalid product data');
            return;
        }
        
        const price = parseFloat(productPrice) || 0;
        const qty = parseInt(quantity) || 1;
        
        const existingItem = AppState.cart.find(item => item.id === productId);
        
        if (existingItem) {
            existingItem.quantity += qty;
        } else {
            AppState.cart.push({
                id: productId,
                name: productName,
                price: price,
                image: productImage,
                quantity: qty
            });
        }
        
        updateCartUI();
        showNotification(`${productName} added to cart!`, 'success');
    }

    function removeFromCart(productId) {
        AppState.cart = AppState.cart.filter(item => item.id !== productId);
        updateCartUI();
        showNotification('Item removed from cart', 'info');
    }

    function updateCartQuantity(productId, action) {
        const item = AppState.cart.find(item => item.id === productId);
        
        if (item) {
            if (action === 'increase') {
                item.quantity = (item.quantity || 1) + 1;
            } else if (action === 'decrease' && (item.quantity || 1) > 1) {
                item.quantity = (item.quantity || 1) - 1;
            }
            
            updateCartUI();
        }
    }

    function saveCart() {
        try {
            localStorage.setItem('pdsaCart', JSON.stringify(AppState.cart));
        } catch (error) {
            console.error('Error saving cart to localStorage:', error);
        }
    }

    // Enhanced Checkout Function
    function checkout() {
        if (!AppState.currentUser) {
            showNotification('Please log in to checkout', 'warning');
            showModal('login-modal');
            return;
        }
        
        if (AppState.cart.length === 0) {
            showNotification('Your cart is empty', 'warning');
            return;
        }
        
        // Process checkout
        showNotification('Processing your order...', 'info');
        
        try {
            const orderId = 'ORD-' + Date.now();
            const subtotal = AppState.cart.reduce((sum, item) => {
                const price = parseFloat(item.price || 0);
                const quantity = item.quantity || 1;
                return sum + (price * quantity);
            }, 0);
            const shipping = subtotal > 0 ? 50 : 0;
            const total = subtotal + shipping;
            
            const order = {
                id: orderId,
                userId: AppState.currentUser.uid,
                userEmail: AppState.currentUser.email,
                items: AppState.cart.map(item => ({
                    id: item.id,
                    name: item.name,
                    price: parseFloat(item.price),
                    quantity: item.quantity || 1,
                    image: item.image,
                    subtotal: parseFloat(item.price) * (item.quantity || 1)
                })),
                subtotal: subtotal,
                shipping: shipping,
                total: total,
                status: 'pending',
                paymentStatus: 'pending',
                date: new Date().toISOString(),
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            // Save order to Firestore
            db.collection('orders').add(order)
                .then((docRef) => {
                    order.firebaseId = docRef.id;
                    AppState.userOrders.unshift(order);
                    
                    // Clear cart
                    AppState.cart = [];
                    saveCart();
                    updateCartUI();
                    closeCart();
                    
                    showNotification(`Order #${orderId} placed successfully!`, 'success');
                    
                    // Show order tracking
                    setTimeout(() => {
                        showOrderTracking(order.firebaseId);
                    }, 1000);
                })
                .catch((error) => {
                    console.error('Error saving order:', error);
                    showNotification('Error processing your order. Please try again.', 'error');
                });
            
        } catch (error) {
            console.error('Error during checkout:', error);
            showNotification('Error processing your order. Please try again.', 'error');
        }
    }

    // Authentication Management
    function updateAuthUI() {
        const loginBtn = DOM.auth.loginBtn;
        const registerBtn = DOM.auth.registerBtn;
        const userMenu = DOM.auth.userMenu;
        const authOverlays = document.querySelectorAll('.auth-overlay');
        const bookAppointmentBtn = document.getElementById('book-appointment-btn');
        const footerBookAppointment = document.getElementById('footer-book-appointment');
        const productCards = document.querySelectorAll('.product-card.auth-required');
        
        if (AppState.currentUser) {
            // User is logged in
            if (loginBtn) loginBtn.style.display = 'none';
            if (registerBtn) registerBtn.style.display = 'none';
            if (userMenu) userMenu.style.display = 'block';
            
            // Hide auth overlays on products
            authOverlays.forEach(overlay => {
                if (overlay) overlay.style.display = 'none';
            });
            
            // Enable product interactions
            productCards.forEach(card => {
                card.classList.remove('auth-required');
            });
            
            if (AppState.cart.length > 0 && DOM.cart.checkoutBtn) {
                DOM.cart.checkoutBtn.disabled = false;
            }
            
            // Enable appointment booking
            if (bookAppointmentBtn) {
                bookAppointmentBtn.onclick = function() {
                    showModal('appointment-modal');
                };
            }
            
            if (footerBookAppointment) {
                footerBookAppointment.onclick = function(e) {
                    e.preventDefault();
                    showModal('appointment-modal');
                };
            }
            
            // Enable add to cart buttons
            document.querySelectorAll('.add-to-cart').forEach(btn => {
                btn.disabled = false;
                btn.style.opacity = '1';
            });
            
        } else {
            // User is not logged in
            if (loginBtn) loginBtn.style.display = 'inline-flex';
            if (registerBtn) registerBtn.style.display = 'inline-flex';
            if (userMenu) userMenu.style.display = 'none';
            
            // Show auth overlays on products
            authOverlays.forEach(overlay => {
                if (overlay) overlay.style.display = 'flex';
            });
            
            // Disable product interactions
            productCards.forEach(card => {
                card.classList.add('auth-required');
            });
            
            if (DOM.cart.checkoutBtn) {
                DOM.cart.checkoutBtn.disabled = true;
            }
            
            // Redirect to login for appointments
            if (bookAppointmentBtn) {
                bookAppointmentBtn.onclick = function(e) {
                    e.preventDefault();
                    showModal('login-modal');
                };
            }
            
            if (footerBookAppointment) {
                footerBookAppointment.onclick = function(e) {
                    e.preventDefault();
                    showModal('login-modal');
                };
            }
            
            // Disable add to cart buttons
            document.querySelectorAll('.add-to-cart').forEach(btn => {
                btn.disabled = true;
                btn.style.opacity = '0.6';
            });
        }
    }

    // Firebase Authentication
    function login(email, password) {
        if (!email || !password) {
            showNotification('Please enter email and password', 'error');
            return;
        }
        
        showNotification('Logging in...', 'info');
        
        auth.signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
                const user = userCredential.user;
                AppState.currentUser = {
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName || user.email.split('@')[0],
                    emailVerified: user.emailVerified
                };
                
                updateUserUI(AppState.currentUser);
                updateAuthUI();
                loadUserData();
                
                showNotification('Login successful!', 'success');
                hideModal('login-modal');
            })
            .catch((error) => {
                console.error('Login error:', error);
                let errorMessage = 'Login failed';
                switch (error.code) {
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address';
                        break;
                    case 'auth/user-disabled':
                        errorMessage = 'This account has been disabled';
                        break;
                    case 'auth/user-not-found':
                        errorMessage = 'No account found with this email';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Incorrect password';
                        break;
                    default:
                        errorMessage = error.message;
                }
                showNotification(errorMessage, 'error');
            });
    }

    function register(userData) {
        if (!userData.email || !userData.password) {
            showNotification('Please fill in all required fields', 'error');
            return;
        }
        
        if (userData.password !== userData.confirmPassword) {
            showNotification('Passwords do not match', 'error');
            return;
        }
        
        showNotification('Creating account...', 'info');
        
        auth.createUserWithEmailAndPassword(userData.email, userData.password)
            .then((userCredential) => {
                const user = userCredential.user;
                
                // Save additional user data to Firestore
                return db.collection('users').doc(user.uid).set({
                    firstName: userData.firstname || '',
                    lastName: userData.lastname || '',
                    email: userData.email,
                    phone: userData.phone || '',
                    address: userData.address || '',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                }).then(() => {
                    AppState.currentUser = {
                        uid: user.uid,
                        email: user.email,
                        displayName: `${userData.firstname || ''} ${userData.lastname || ''}`.trim() || user.email.split('@')[0],
                        emailVerified: false
                    };
                    
                    updateUserUI(AppState.currentUser);
                    updateAuthUI();
                    
                    showNotification('Registration successful! Welcome to PDSA Veterinary Clinic.', 'success');
                    hideModal('register-modal');
                });
            })
            .catch((error) => {
                console.error('Registration error:', error);
                let errorMessage = 'Registration failed';
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'Email already in use';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'Password is too weak';
                        break;
                    default:
                        errorMessage = error.message;
                }
                showNotification(errorMessage, 'error');
            });
    }

    function logout() {
        auth.signOut()
            .then(() => {
                AppState.currentUser = null;
                AppState.isAdmin = false;
                AppState.userPets = [];
                AppState.userAppointments = [];
                AppState.userOrders = [];
                updateCartUI();
                showNotification('Logged out successfully', 'info');
                updateAuthUI();
                hideModal('dashboard-modal');
            })
            .catch((error) => {
                console.error('Logout error:', error);
                showNotification('Error logging out: ' + error.message, 'error');
            });
    }

    function updateUserUI(userData) {
        const userName = DOM.auth.userName;
        if (userData && userName) {
            userName.textContent = userData.displayName || userData.email;
        }
    }

    function checkAdminStatus(uid) {
        if (!uid) return;
        
        db.collection('admins').doc(uid).get()
            .then((doc) => {
                if (doc.exists) {
                    AppState.isAdmin = true;
                    const adminPanel = document.getElementById('admin-panel');
                    const adminLink = document.getElementById('admin-link');
                    if (adminPanel) adminPanel.style.display = 'block';
                    if (adminLink) adminLink.style.display = 'inline-flex';
                    loadAdminStats();
                }
            })
            .catch((error) => {
                console.error('Error checking admin status:', error);
            });
    }

    // Enhanced Appointment Management
    function setupAppointmentBooking() {
        const appointmentForm = document.getElementById('appointment-form');
        if (appointmentForm) {
            appointmentForm.addEventListener('submit', function(e) {
                e.preventDefault();
                bookAppointment();
            });
        }
        
        const confirmBtn = document.getElementById('confirm-appointment');
        const editBtn = document.getElementById('edit-appointment');
        
        if (confirmBtn) {
            confirmBtn.addEventListener('click', confirmAppointment);
        }
        if (editBtn) {
            editBtn.addEventListener('click', showAppointmentForm);
        }
        
        const addPetForm = document.getElementById('add-pet-form');
        if (addPetForm) {
            addPetForm.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewPet();
            });
        }
    }

    function bookAppointment() {
        if (!AppState.currentUser) {
            showNotification('Please log in to book an appointment', 'warning');
            showModal('login-modal');
            return;
        }
        
        const petSelect = document.getElementById('appointment-pet');
        const serviceSelect = document.getElementById('appointment-service');
        const dateInput = document.getElementById('appointment-date');
        const timeSelect = document.getElementById('appointment-time');
        const reasonTextarea = document.getElementById('appointment-reason');
        
        // Validate form
        if (!petSelect || !petSelect.value) {
            showNotification('Please select a pet', 'error');
            return;
        }
        
        if (!serviceSelect || !serviceSelect.value) {
            showNotification('Please select a service', 'error');
            return;
        }
        
        if (!dateInput || !dateInput.value) {
            showNotification('Please select a date', 'error');
            return;
        }
        
        if (!timeSelect || !timeSelect.value) {
            showNotification('Please select a time', 'error');
            return;
        }
        
        const selectedPet = AppState.userPets.find(pet => pet.id === petSelect.value);
        const selectedService = AppState.services.find(s => s.id == serviceSelect.value);
        
        if (!selectedPet) {
            showNotification('Selected pet not found. Please refresh and try again.', 'error');
            return;
        }
        
        if (!selectedService) {
            showNotification('Selected service not found. Please refresh and try again.', 'error');
            return;
        }
        
        // Show confirmation
        const confirmPet = document.getElementById('confirm-pet');
        const confirmService = document.getElementById('confirm-service');
        const confirmDate = document.getElementById('confirm-date');
        const confirmTime = document.getElementById('confirm-time');
        const confirmReason = document.getElementById('confirm-reason');
        
        if (confirmPet) confirmPet.textContent = `${selectedPet.name} (${selectedPet.species})`;
        if (confirmService) confirmService.textContent = `${selectedService.name} - R${selectedService.price}`;
        if (confirmDate) confirmDate.textContent = formatDate(dateInput.value);
        if (confirmTime) confirmTime.textContent = formatTime(timeSelect.value);
        if (confirmReason) confirmReason.textContent = reasonTextarea.value || 'Not specified';
        
        const step1 = document.getElementById('appointment-step-1');
        const step2 = document.getElementById('appointment-step-2');
        
        if (step1) step1.style.display = 'none';
        if (step2) step2.style.display = 'block';
    }

    function confirmAppointment() {
        const petSelect = document.getElementById('appointment-pet');
        const serviceSelect = document.getElementById('appointment-service');
        const dateInput = document.getElementById('appointment-date');
        const timeSelect = document.getElementById('appointment-time');
        const reasonTextarea = document.getElementById('appointment-reason');
        
        if (!petSelect || !serviceSelect || !dateInput || !timeSelect) {
            showNotification('Error: Form data incomplete', 'error');
            return;
        }
        
        const selectedPet = AppState.userPets.find(pet => pet.id === petSelect.value);
        const selectedService = AppState.services.find(s => s.id == serviceSelect.value);
        
        if (!selectedPet || !selectedService) {
            showNotification('Error: Pet or service not found', 'error');
            return;
        }
        
        const appointmentData = {
            userId: AppState.currentUser.uid,
            userEmail: AppState.currentUser.email,
            petId: petSelect.value,
            petName: selectedPet.name,
            petSpecies: selectedPet.species,
            serviceId: serviceSelect.value,
            serviceName: selectedService.name,
            servicePrice: selectedService.price,
            date: dateInput.value,
            time: timeSelect.value,
            reason: reasonTextarea.value || '',
            status: 'pending',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        // Show loading state
        const confirmBtn = document.getElementById('confirm-appointment');
        if (confirmBtn) {
            const originalText = confirmBtn.innerHTML;
            confirmBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
            confirmBtn.disabled = true;
        }
        
        // Save to Firestore
        db.collection('appointments').add(appointmentData)
            .then((docRef) => {
                // Add to local state
                appointmentData.id = docRef.id;
                AppState.userAppointments.push(appointmentData);
                
                // Reset button
                if (confirmBtn) {
                    confirmBtn.innerHTML = 'Confirm Booking';
                    confirmBtn.disabled = false;
                }
                
                // Reset form and show success
                hideModal('appointment-modal');
                const appointmentForm = document.getElementById('appointment-form');
                if (appointmentForm) appointmentForm.reset();
                showAppointmentForm();
                
                // Reload appointments to ensure UI is updated
                loadUserAppointments();
                
                showNotification('Appointment booked successfully! We will confirm shortly.', 'success');
            })
            .catch((error) => {
                console.error('Error saving appointment:', error);
                
                // Reset button
                if (confirmBtn) {
                    confirmBtn.innerHTML = 'Confirm Booking';
                    confirmBtn.disabled = false;
                }
                
                showNotification('Error booking appointment: ' + error.message, 'error');
            });
    }

    function showAppointmentForm() {
        const step1 = document.getElementById('appointment-step-1');
        const step2 = document.getElementById('appointment-step-2');
        
        if (step1) step1.style.display = 'block';
        if (step2) step2.style.display = 'none';
    }

    // Enhanced Pet Management - FIXED VERSION
    function loadUserPets() {
        if (!AppState.currentUser) {
            console.log('No user logged in, skipping pet load');
            return;
        }
        
        const petsList = document.getElementById('user-pets-list');
        if (petsList) {
            petsList.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner"></i><p>Loading pets...</p></div>';
        }
        
        // FIX: Use a simpler query that doesn't require composite indexes
        db.collection('pets')
            .where('userId', '==', AppState.currentUser.uid)
            .get()
            .then((querySnapshot) => {
                AppState.userPets = [];
                querySnapshot.forEach((doc) => {
                    const pet = doc.data();
                    pet.id = doc.id;
                    AppState.userPets.push(pet);
                });
                
                // Sort pets by creation date on the client side
                AppState.userPets.sort((a, b) => {
                    const dateA = a.createdAt ? a.createdAt.toDate() : new Date(0);
                    const dateB = b.createdAt ? b.createdAt.toDate() : new Date(0);
                    return dateB - dateA;
                });
                
                updateAppointmentPetDropdown();
                renderUserPets();
            })
            .catch((error) => {
                console.error('Error loading pets:', error);
                showNotification('Error loading pets: ' + error.message, 'error');
            });
    }

    function addNewPet() {
        const form = document.getElementById('add-pet-form');
        if (!form) return;
        
        const formData = new FormData(form);
        const petData = {
            userId: AppState.currentUser.uid,
            name: formData.get('name') || '',
            species: formData.get('species') || '',
            breed: formData.get('breed') || '',
            dateOfBirth: formData.get('dateOfBirth') || '',
            gender: formData.get('gender') || '',
            color: formData.get('color') || '',
            weight: parseFloat(formData.get('weight')) || 0,
            medicalNotes: formData.get('medicalNotes') || '',
            microchipNumber: formData.get('microchipNumber') || '',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        // Validate required fields
        if (!petData.name || !petData.species) {
            showNotification('Please fill in pet name and species', 'error');
            return;
        }
        
        // Save to Firestore
        db.collection('pets').add(petData)
            .then((docRef) => {
                petData.id = docRef.id;
                AppState.userPets.push(petData);
                
                hideModal('add-pet-modal');
                form.reset();
                
                showNotification(`${petData.name} has been added to your pets!`, 'success');
                
                // If we came from appointment modal, go back
                if (document.getElementById('appointment-modal').classList.contains('active')) {
                    showModal('appointment-modal');
                }
            })
            .catch((error) => {
                console.error('Error adding pet:', error);
                showNotification('Error adding pet. Please try again.', 'error');
            });
    }

    function updateAppointmentPetDropdown() {
        const petSelect = document.getElementById('appointment-pet');
        if (!petSelect) return;
        
        petSelect.innerHTML = '<option value="">Select a pet</option>';
        
        AppState.userPets.forEach(pet => {
            const option = document.createElement('option');
            option.value = pet.id;
            option.textContent = `${pet.name} (${pet.species})`;
            petSelect.appendChild(option);
        });
        
        if (AppState.userPets.length === 0) {
            petSelect.innerHTML = '<option value="">No pets registered. Please add a pet first.</option>';
            petSelect.disabled = true;
        } else {
            petSelect.disabled = false;
        }
    }

    // Event Listeners Setup
    function setupEventListeners() {
        setupAuthEventListeners();
        setupCartEventListeners();
        setupProductEventListeners();
        setupFAQ();
        setupNavScroll();
        setupContactForm();
    }

    function setupAuthEventListeners() {
        // Login form
        const loginForm = document.getElementById('login-form');
        if (loginForm) {
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(this);
                login(formData.get('email'), formData.get('password'));
            });
        }
        
        // Register form
        const registerForm = document.getElementById('register-form');
        if (registerForm) {
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(this);
                register({
                    firstname: formData.get('firstname'),
                    lastname: formData.get('lastname'),
                    email: formData.get('email'),
                    password: formData.get('password'),
                    confirmPassword: formData.get('confirmPassword'),
                    phone: formData.get('phone'),
                    address: formData.get('address')
                });
            });
        }
        
        // Logout
        const logoutLink = document.getElementById('logout-link');
        if (logoutLink) {
            logoutLink.addEventListener('click', function(e) {
                e.preventDefault();
                logout();
            });
        }
        
        // User dashboard
        const dashboardLink = document.getElementById('user-dashboard-link');
        if (dashboardLink) {
            dashboardLink.addEventListener('click', function(e) {
                e.preventDefault();
                showDashboard();
            });
        }
        
        // Login from product
        document.querySelectorAll('#login-from-product').forEach(btn => {
            btn.addEventListener('click', function() {
                showModal('login-modal');
            });
        });
        
        // Login and Register buttons
        if (DOM.auth.loginBtn) {
            DOM.auth.loginBtn.addEventListener('click', function() {
                showModal('login-modal');
            });
        }
        
        if (DOM.auth.registerBtn) {
            DOM.auth.registerBtn.addEventListener('click', function() {
                showModal('register-modal');
            });
        }
    }

    function setupCartEventListeners() {
        // Cart toggle
        const cartBtn = document.getElementById('cart-btn');
        const closeCartBtn = document.getElementById('close-cart');
        const continueShoppingBtn = document.getElementById('continue-shopping');
        
        if (cartBtn) {
            cartBtn.addEventListener('click', function() {
                if (DOM.cart.container) DOM.cart.container.classList.add('open');
                if (DOM.cart.overlay) DOM.cart.overlay.classList.add('open');
            });
        }
        
        if (closeCartBtn) {
            closeCartBtn.addEventListener('click', closeCart);
        }
        
        if (DOM.cart.overlay) {
            DOM.cart.overlay.addEventListener('click', closeCart);
        }
        
        if (continueShoppingBtn) {
            continueShoppingBtn.addEventListener('click', function() {
                closeCart();
                const productsSection = document.getElementById('products');
                if (productsSection) {
                    productsSection.scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        }
        
        // Checkout button
        if (DOM.cart.checkoutBtn) {
            DOM.cart.checkoutBtn.addEventListener('click', checkout);
        }
    }

    function setupProductEventListeners() {
        // Add to cart buttons
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.addEventListener('click', function() {
                const productCard = this.closest('.product-card');
                if (!productCard) return;
                
                const productId = this.getAttribute('data-product-id');
                const productName = this.getAttribute('data-product-name');
                const productPrice = this.getAttribute('data-product-price');
                const productImage = productCard.querySelector('.product-img img')?.src;
                const quantityInput = productCard.querySelector('.quantity-input');
                const quantity = quantityInput ? parseInt(quantityInput.value) || 1 : 1;
                
                addToCart(productId, productName, productPrice, productImage, quantity);
                
                // Reset quantity
                if (quantityInput) quantityInput.value = 1;
            });
        });
        
        // Product filters
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const filter = this.getAttribute('data-filter');
                
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.product-card').forEach(card => {
                    if (filter === 'all' || card.getAttribute('data-category') === filter) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
        });
        
        // Quantity controls
        document.querySelectorAll('.quantity-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const action = this.getAttribute('data-action');
                const input = this.parentElement.querySelector('.quantity-input');
                if (!input) return;
                
                let value = parseInt(input.value) || 1;
                
                if (action === 'increase' && value < 10) {
                    input.value = value + 1;
                } else if (action === 'decrease' && value > 1) {
                    input.value = value - 1;
                }
            });
        });
    }

    function setupCartIconToProducts() {
        const cartBtn = document.getElementById('cart-btn');
        
        if (cartBtn) {
            cartBtn.addEventListener('click', function(e) {
                // If cart is empty, scroll to products
                if (AppState.cart.length === 0) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Close cart if it's open
                    closeCart();
                    
                    // Show notification
                    showNotification('Your cart is empty! Taking you to our products.', 'info');
                    
                    // Scroll to products section smoothly
                    const productsSection = document.getElementById('products');
                    if (productsSection) {
                        productsSection.scrollIntoView({ 
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        // Update navigation highlight
                        document.querySelectorAll('nav a').forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#products') {
                                link.classList.add('active');
                            }
                        });
                    }
                } else {
                    // If cart has items, open cart normally
                    if (DOM.cart.container) DOM.cart.container.classList.add('open');
                    if (DOM.cart.overlay) DOM.cart.overlay.classList.add('open');
                }
            });
        }
    }

    function setupContactForm() {
        const contactForm = document.getElementById('contact-form');
        if (!contactForm) return;
        
        contactForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const contactData = {
                name: formData.get('name') || '',
                email: formData.get('email') || '',
                phone: formData.get('phone') || '',
                subject: formData.get('subject') || 'general',
                message: formData.get('message') || '',
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'new'
            };
            
            // Validate required fields
            if (!contactData.name || !contactData.email || !contactData.message) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            showNotification('Sending your message...', 'info');
            
            // Save to Firestore
            db.collection('contactMessages').add(contactData)
                .then((docRef) => {
                    showNotification('Your message has been sent successfully! We will get back to you soon.', 'success');
                    contactForm.reset();
                })
                .catch((error) => {
                    console.error('Error sending message:', error);
                    showNotification('Error sending message. Please try again.', 'error');
                });
        });
    }

    function setupModals() {
        // Login/Register modal toggles
        const showRegister = document.getElementById('show-register');
        const showLogin = document.getElementById('show-login');
        
        if (showRegister) {
            showRegister.addEventListener('click', function(e) {
                e.preventDefault();
                hideModal('login-modal');
                showModal('register-modal');
            });
        }
        
        if (showLogin) {
            showLogin.addEventListener('click', function(e) {
                e.preventDefault();
                hideModal('register-modal');
                showModal('login-modal');
            });
        }
        
        // Add pet link in appointment modal
        const addPetLink = document.getElementById('add-pet-link');
        if (addPetLink) {
            addPetLink.addEventListener('click', function(e) {
                e.preventDefault();
                hideModal('appointment-modal');
                showModal('add-pet-modal');
            });
        }
        
        // Cancel add pet
        const cancelAddPet = document.getElementById('cancel-add-pet');
        if (cancelAddPet) {
            cancelAddPet.addEventListener('click', function() {
                hideModal('add-pet-modal');
                showModal('appointment-modal');
            });
        }
        
        // Modal close buttons
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.modal-overlay').forEach(modal => {
                    modal.classList.remove('active');
                });
            });
        });
        
        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                document.querySelectorAll('.modal-overlay').forEach(modal => {
                    modal.classList.remove('active');
                });
            }
        });
    }

    function setupFAQ() {
        document.querySelectorAll('.faq-question').forEach(question => {
            question.addEventListener('click', () => {
                const item = question.parentElement;
                item.classList.toggle('active');
            });
        });
    }

    function setupNavScroll() {
        window.addEventListener('scroll', () => {
            const scrollPosition = window.scrollY;
            
            document.querySelectorAll('section').forEach(section => {
                const sectionTop = section.offsetTop - 100;
                const sectionBottom = sectionTop + section.offsetHeight;
                const sectionId = section.getAttribute('id');
                
                if (scrollPosition >= sectionTop && scrollPosition < sectionBottom) {
                    document.querySelectorAll('nav a').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === `#${sectionId}`) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        });

        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href');
                const targetSection = document.querySelector(targetId);
                
                if (targetSection) {
                    window.scrollTo({
                        top: targetSection.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    
                    document.querySelectorAll('nav a').forEach(navLink => navLink.classList.remove('active'));
                    link.classList.add('active');
                }
            });
        });
    }

    function setupDateRestrictions() {
        const dateInput = document.getElementById('appointment-date');
        if (dateInput) {
            const today = new Date().toISOString().split('T')[0];
            dateInput.min = today;
        }
    }

    // Utility Functions
    function showModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.add('active');
        }
    }

    function hideModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('active');
        }
    }

    function closeCart() {
        if (DOM.cart.container) DOM.cart.container.classList.remove('open');
        if (DOM.cart.overlay) DOM.cart.overlay.classList.remove('open');
    }

    function showDashboard() {
        if (!AppState.currentUser) {
            showNotification('Please log in to view your dashboard', 'warning');
            showModal('login-modal');
            return;
        }
        loadUserData();
        showModal('dashboard-modal');
    }

    function showAppointmentModal() {
        if (!AppState.currentUser) {
            showNotification('Please log in to book an appointment', 'warning');
            showModal('login-modal');
            return;
        }
        updateAppointmentPetDropdown();
        showModal('appointment-modal');
    }

    function showAddPetModal() {
        if (!AppState.currentUser) {
            showNotification('Please log in to add a pet', 'warning');
            showModal('login-modal');
            return;
        }
        showModal('add-pet-modal');
    }

    function scrollToProducts() {
        const productsSection = document.getElementById('products');
        if (productsSection) {
            productsSection.scrollIntoView({ behavior: 'smooth' });
        }
        hideModal('dashboard-modal');
    }

    function showAdminPanel() {
        showNotification('Admin panel would open here', 'info');
    }

    function calculateAge(dateString) {
        if (!dateString) return 'Unknown';
        
        const birthDate = new Date(dateString);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        const monthDiff = today.getMonth() - birthDate.getMonth();
        
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
            age--;
        }
        
        return age;
    }

    function formatDate(dateString) {
        if (!dateString) return 'Invalid date';
        
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        return new Date(dateString).toLocaleDateString(undefined, options);
    }

    function formatTime(timeString) {
        if (!timeString) return 'Invalid time';
        
        const [hours, minutes] = timeString.split(':');
        const hour = parseInt(hours);
        const ampm = hour >= 12 ? 'PM' : 'AM';
        const displayHour = hour % 12 || 12;
        return `${displayHour}:${minutes} ${ampm}`;
    }

    function getServiceName(serviceId) {
        const service = AppState.services.find(s => s.id == serviceId);
        return service ? service.name : 'Unknown Service';
    }

    // Enhanced Notification System
    function showNotification(message, type) {
        // Create notification container if it doesn't exist
        let container = document.getElementById('notification-container');
        if (!container) {
            container = document.createElement('div');
            container.id = 'notification-container';
            container.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 10000;';
            document.body.appendChild(container);
        }
        
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <span>${message}</span>
            <button class="close-notification">&times;</button>
        `;
        
        container.appendChild(notification);
        
        // Show notification
        setTimeout(() => {
            notification.classList.add('show');
        }, 100);
        
        // Auto remove after 5 seconds
        const autoRemove = setTimeout(() => {
            closeNotification(notification);
        }, 5000);
        
        // Close button event
        const closeBtn = notification.querySelector('.close-notification');
        if (closeBtn) {
            closeBtn.addEventListener('click', () => {
                clearTimeout(autoRemove);
                closeNotification(notification);
            });
        }
        
        function closeNotification(notif) {
            notif.classList.remove('show');
            setTimeout(() => {
                if (notif.parentNode) {
                    notif.parentNode.removeChild(notif);
                }
            }, 300);
        }
    }

    // User Dashboard
    function loadUserData() {
        loadUserPets();
        loadUserAppointments();
        loadUserOrders();
    }

    function loadUserAppointments() {
        if (!AppState.currentUser) return;
        
        const appointmentsList = document.getElementById('user-appointments-list');
        if (appointmentsList) {
            appointmentsList.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner"></i><p>Loading appointments...</p></div>';
        }
        
        // FIX: Use simpler query without composite indexes
        db.collection('appointments')
            .where('userId', '==', AppState.currentUser.uid)
            .get()
            .then((querySnapshot) => {
                AppState.userAppointments = [];
                querySnapshot.forEach((doc) => {
                    const appointment = doc.data();
                    appointment.id = doc.id;
                    AppState.userAppointments.push(appointment);
                });
                
                // Sort appointments by creation date on client side
                AppState.userAppointments.sort((a, b) => {
                    const dateA = a.createdAt ? a.createdAt.toDate() : new Date(0);
                    const dateB = b.createdAt ? b.createdAt.toDate() : new Date(0);
                    return dateB - dateA;
                });
                
                renderUserAppointments();
            })
            .catch((error) => {
                console.error('Error loading appointments:', error);
                showNotification('Error loading appointments', 'error');
            });
    }

    function loadUserOrders() {
        if (!AppState.currentUser) return;
        
        const ordersList = document.getElementById('user-orders-list');
        if (ordersList) {
            ordersList.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner"></i><p>Loading orders...</p></div>';
        }
        
        // FIX: Use simpler query without composite indexes
        db.collection('orders')
            .where('userId', '==', AppState.currentUser.uid)
            .get()
            .then((querySnapshot) => {
                AppState.userOrders = [];
                querySnapshot.forEach((doc) => {
                    const order = doc.data();
                    order.firebaseId = doc.id;
                    AppState.userOrders.push(order);
                });
                
                // Sort orders by creation date on client side
                AppState.userOrders.sort((a, b) => {
                    const dateA = a.createdAt ? a.createdAt.toDate() : new Date(0);
                    const dateB = b.createdAt ? b.createdAt.toDate() : new Date(0);
                    return dateB - dateA;
                });
                
                renderUserOrders();
            })
            .catch((error) => {
                console.error('Error loading orders:', error);
                showNotification('Error loading orders', 'error');
            });
    }

    function loadAdminStats() {
        if (!AppState.isAdmin) return;
        
        // Load today's appointments
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        db.collection('appointments')
            .where('date', '==', today.toISOString().split('T')[0])
            .get()
            .then((querySnapshot) => {
                const statElement = document.getElementById('stat-appointments');
                if (statElement) statElement.textContent = querySnapshot.size;
            });
        
        // Load pending orders
        db.collection('orders')
            .where('status', '==', 'pending')
            .get()
            .then((querySnapshot) => {
                const statElement = document.getElementById('stat-orders');
                if (statElement) statElement.textContent = querySnapshot.size;
            });
        
        // Load today's revenue
        db.collection('orders')
            .where('date', '>=', today.toISOString())
            .get()
            .then((querySnapshot) => {
                let revenue = 0;
                querySnapshot.forEach(doc => {
                    revenue += doc.data().total || 0;
                });
                const statElement = document.getElementById('stat-revenue');
                if (statElement) statElement.textContent = `R${revenue.toFixed(2)}`;
            });
    }

    function renderUserPets() {
        const petsList = document.getElementById('user-pets-list');
        if (!petsList) return;
        
        if (AppState.userPets.length === 0) {
            petsList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-paw" style="font-size: 3rem; color: #ddd; margin-bottom: 1rem;"></i>
                    <p>No pets registered yet.</p>
                    <button class="btn btn-primary" onclick="showModal('add-pet-modal')">Add Your First Pet</button>
                </div>
            `;
            return;
        }
        
        petsList.innerHTML = AppState.userPets.map(pet => `
            <div class="dashboard-card">
                <h4>${pet.name} <small>(${pet.species})</small></h4>
                <p><strong>Breed:</strong> ${pet.breed || 'Unknown'}</p>
                <p><strong>Age:</strong> ${pet.dateOfBirth ? calculateAge(pet.dateOfBirth) + ' years' : 'Unknown'}</p>
                <p><strong>Gender:</strong> ${pet.gender || 'Unknown'}</p>
                <div style="margin-top: 0.5rem;">
                    <button class="btn btn-outline btn-sm" onclick="editPet('${pet.id}')">Edit</button>
                    <button class="btn btn-outline btn-sm" onclick="viewPetHistory('${pet.id}')">History</button>
                </div>
            </div>
        `).join('');
    }

    function renderUserAppointments() {
        const appointmentsList = document.getElementById('user-appointments-list');
        if (!appointmentsList) return;
        
        if (AppState.userAppointments.length === 0) {
            appointmentsList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-calendar-times" style="font-size: 3rem; color: #ddd; margin-bottom: 1rem;"></i>
                    <p>No appointments scheduled.</p>
                    <button class="btn btn-primary" onclick="showModal('appointment-modal')">Book Your First Appointment</button>
                </div>
            `;
            return;
        }
        
        const upcomingAppointments = AppState.userAppointments
            .filter(apt => new Date(apt.date) >= new Date())
            .sort((a, b) => new Date(a.date) - new Date(b.date))
            .slice(0, 3);
        
        if (upcomingAppointments.length === 0) {
            appointmentsList.innerHTML = '<p>No upcoming appointments.</p>';
            return;
        }
        
        appointmentsList.innerHTML = upcomingAppointments.map(apt => `
            <div class="dashboard-card">
                <h4>${getServiceName(apt.serviceId)}</h4>
                <p><strong>Pet:</strong> ${apt.petName}</p>
                <p><strong>Date:</strong> ${formatDate(apt.date)} at ${apt.time}</p>
                <p><strong>Status:</strong> <span class="status status-${apt.status}">${apt.status}</span></p>
                <div style="margin-top: 0.5rem;">
                    <button class="btn btn-outline btn-sm" onclick="viewAppointment('${apt.id}')">Details</button>
                    ${apt.status === 'pending' ? `<button class="btn btn-outline btn-sm" onclick="cancelAppointment('${apt.id}')">Cancel</button>` : ''}
                </div>
            </div>
        `).join('');
    }

    function renderUserOrders() {
        const ordersList = document.getElementById('user-orders-list');
        if (!ordersList) return;
        
        if (AppState.userOrders.length === 0) {
            ordersList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-shopping-cart" style="font-size: 3rem; color: #ddd; margin-bottom: 1rem;"></i>
                    <p>No orders yet.</p>
                    <button class="btn btn-primary" onclick="scrollToProducts()">Start Shopping</button>
                </div>
            `;
            return;
        }
        
        const recentOrders = AppState.userOrders.slice(0, 3);
        
        ordersList.innerHTML = recentOrders.map(order => `
            <div class="dashboard-card">
                <h4>Order #${order.id}</h4>
                <p><strong>Date:</strong> ${formatDate(order.date)}</p>
                <p><strong>Items:</strong> ${order.items.length} item(s)</p>
                <p><strong>Total:</strong> R${order.total.toFixed(2)}</p>
                <p><strong>Status:</strong> <span class="status status-${order.status}">${order.status}</span></p>
                <div style="margin-top: 0.5rem;">
                    <button class="btn btn-outline btn-sm" onclick="viewOrder('${order.firebaseId}')">View Details</button>
                </div>
            </div>
        `).join('');
    }

    // Order Tracking System
    function showOrderTracking(orderId) {
        if (!orderId) return;
        
        db.collection('orders').doc(orderId).get()
            .then((doc) => {
                if (doc.exists) {
                    const order = doc.data();
                    order.firebaseId = doc.id;
                    
                    const modal = createOrderTrackingModal(order);
                    document.body.appendChild(modal);
                    showCustomModal(modal);
                } else {
                    showNotification('Order not found', 'error');
                }
            })
            .catch((error) => {
                console.error('Error loading order:', error);
                showNotification('Error loading order details', 'error');
            });
    }

    function createOrderTrackingModal(order) {
        const modal = document.createElement('div');
        modal.className = 'modal-overlay active';
        modal.innerHTML = `
            <div class="modal-dialog" style="max-width: 800px;">
                <div class="modal-header">
                    <h2>Order Tracking - #${order.id}</h2>
                    <button class="close-modal" onclick="this.closest('.modal-overlay').remove()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="order-tracking-container">
                        <div class="order-tracking-header">
                            <h3>Order #${order.id}</h3>
                            <p>Placed on ${formatDate(order.date)}</p>
                            <div class="status-badge status-${order.status}">${order.status}</div>
                        </div>
                        
                        <div class="tracking-timeline">
                            ${generateOrderTimeline(order)}
                        </div>
                        
                        <div class="order-details-grid">
                            <div class="order-detail-card">
                                <h4>Order Items</h4>
                                <div class="order-items-list">
                                    ${order.items.map(item => `
                                        <div class="order-item">
                                            <div class="order-item-info">
                                                <div class="order-item-img">
                                                    <img src="${item.image || 'https://via.placeholder.com/50'}" alt="${item.name}">
                                                </div>
                                                <div>
                                                    <div class="order-item-name">${item.name}</div>
                                                    <div class="order-item-meta">Qty: ${item.quantity}  R${item.price.toFixed(2)}</div>
                                                </div>
                                            </div>
                                            <div class="order-item-total">R${item.subtotal.toFixed(2)}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="order-detail-card">
                                <h4>Order Summary</h4>
                                <div class="order-totals">
                                    <div class="total-line">
                                        <span>Subtotal:</span>
                                        <span>R${order.subtotal.toFixed(2)}</span>
                                    </div>
                                    <div class="total-line">
                                        <span>Shipping:</span>
                                        <span>R${order.shipping.toFixed(2)}</span>
                                    </div>
                                    <div class="total-line grand-total">
                                        <span>Total:</span>
                                        <span>R${order.total.toFixed(2)}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="downloadInvoice('${order.firebaseId}')">
                        <i class="fas fa-download"></i> Download Invoice
                    </button>
                    <button class="btn btn-outline" onclick="this.closest('.modal-overlay').remove()">Close</button>
                </div>
            </div>
        `;
        return modal;
    }

    function generateOrderTimeline(order) {
        const steps = [
            { status: 'pending', label: 'Order Placed', description: 'Your order has been received' },
            { status: 'confirmed', label: 'Order Confirmed', description: 'Payment confirmed and order processing' },
            { status: 'processing', label: 'Processing', description: 'Preparing your items for shipment' },
            { status: 'shipped', label: 'Shipped', description: 'Your order is on the way' },
            { status: 'delivered', label: 'Delivered', description: 'Order delivered successfully' }
        ];
        
        const currentStatusIndex = steps.findIndex(step => step.status === order.status);
        
        return steps.map((step, index) => {
            const isCompleted = index <= currentStatusIndex;
            const isActive = index === currentStatusIndex;
            const stepClass = isCompleted ? 'completed' : (isActive ? 'active' : '');
            
            return `
                <div class="tracking-step ${stepClass}">
                    <div class="tracking-date">${step.label}</div>
                    <div class="tracking-description">${step.description}</div>
                </div>
            `;
        }).join('');
    }

    function downloadInvoice(orderId) {
        showNotification('Generating invoice...', 'info');
        // In a real implementation, this would generate a PDF invoice
        setTimeout(() => {
            showNotification('Invoice downloaded successfully', 'success');
        }, 1000);
    }

    function showCustomModal(modalElement) {
        document.body.appendChild(modalElement);
    }

    // Placeholder functions for future implementation
    function editPet(petId) {
        showNotification('Edit pet functionality would open here', 'info');
    }

    function viewPetHistory(petId) {
        showNotification('Pet history would be displayed here', 'info');
    }

    function viewAppointment(appointmentId) {
        showNotification('Appointment details would be shown here', 'info');
    }

    function cancelAppointment(appointmentId) {
        if (confirm('Are you sure you want to cancel this appointment?')) {
            db.collection('appointments').doc(appointmentId).update({
                status: 'cancelled',
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                // Update local state
                const appointmentIndex = AppState.userAppointments.findIndex(apt => apt.id === appointmentId);
                if (appointmentIndex !== -1) {
                    AppState.userAppointments[appointmentIndex].status = 'cancelled';
                }
                
                showNotification('Appointment cancelled', 'success');
                renderUserAppointments();
            })
            .catch((error) => {
                console.error('Error cancelling appointment:', error);
                showNotification('Error cancelling appointment', 'error');
            });
        }
    }

    function viewOrder(orderId) {
        showOrderTracking(orderId);
    }

    // Hero buttons
    const learnMoreBtn = document.getElementById('learn-more-btn');
    if (learnMoreBtn) {
        learnMoreBtn.addEventListener('click', () => {
            const aboutSection = document.getElementById('about');
            if (aboutSection) {
                aboutSection.scrollIntoView({ behavior: 'smooth' });
            }
        });
    }

    // Emergency button functionality
    const emergencyBanner = document.getElementById('emergency-banner');
    if (emergencyBanner) {
        emergencyBanner.addEventListener('click', (e) => {
            // Emergency button functionality
        });
    }

    // Make functions globally available
    window.showModal = showModal;
    window.hideModal = hideModal;
    window.showAppointmentModal = showAppointmentModal;
    window.showAddPetModal = showAddPetModal;
    window.scrollToProducts = scrollToProducts;
    window.showAdminPanel = showAdminPanel;
    window.editPet = editPet;
    window.viewPetHistory = viewPetHistory;
    window.viewAppointment = viewAppointment;
    window.cancelAppointment = cancelAppointment;
    window.viewOrder = viewOrder;
    window.showOrderTracking = showOrderTracking;
    window.downloadInvoice = downloadInvoice;
</script>
</body>
</html>